{"dependencies":[{"name":"./nodes/AnimatedValue","isAsync":false},{"name":"./NativeAnimatedHelper","isAsync":false},{"name":"ReactNative","isAsync":false},{"name":"fbjs/lib/invariant","isAsync":false}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, module, exports, _dependencyMap) {\n  'use strict';\n\n  function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n  function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\n  function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n  var AnimatedValue = _$$_REQUIRE(_dependencyMap[0], './nodes/AnimatedValue');\n\n  var NativeAnimatedHelper = _$$_REQUIRE(_dependencyMap[1], './NativeAnimatedHelper');\n\n  var ReactNative = _$$_REQUIRE(_dependencyMap[2], 'ReactNative');\n\n  var invariant = _$$_REQUIRE(_dependencyMap[3], 'fbjs/lib/invariant');\n\n  var _require = _$$_REQUIRE(_dependencyMap[1], './NativeAnimatedHelper'),\n      shouldUseNativeDriver = _require.shouldUseNativeDriver;\n\n  function attachNativeEvent(viewRef, eventName, argMapping) {\n    var eventMappings = [];\n\n    var traverse = function traverse(value, path) {\n      if (value instanceof AnimatedValue) {\n        value.__makeNative();\n\n        eventMappings.push({\n          nativeEventPath: path,\n          animatedValueTag: value.__getNativeTag()\n        });\n      } else if (typeof value === 'object') {\n        for (var _key in value) {\n          traverse(value[_key], path.concat(_key));\n        }\n      }\n    };\n\n    invariant(argMapping[0] && argMapping[0].nativeEvent, 'Native driven events only support animated values contained inside `nativeEvent`.');\n    traverse(argMapping[0].nativeEvent, []);\n    var viewTag = ReactNative.findNodeHandle(viewRef);\n    eventMappings.forEach(function (mapping) {\n      NativeAnimatedHelper.API.addAnimatedEventToView(viewTag, eventName, mapping);\n    });\n    return {\n      detach: function detach() {\n        eventMappings.forEach(function (mapping) {\n          NativeAnimatedHelper.API.removeAnimatedEventFromView(viewTag, eventName, mapping.animatedValueTag);\n        });\n      }\n    };\n  }\n\n  var AnimatedEvent = function () {\n    function AnimatedEvent(argMapping) {\n      var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      _classCallCheck(this, AnimatedEvent);\n\n      this._listeners = [];\n      this._argMapping = argMapping;\n\n      if (config.listener) {\n        this.__addListener(config.listener);\n      }\n\n      this._callListeners = this._callListeners.bind(this);\n      this._attachedEvent = null;\n      this.__isNative = shouldUseNativeDriver(config);\n\n      if (__DEV__) {\n        this._validateMapping();\n      }\n    }\n\n    _createClass(AnimatedEvent, [{\n      key: \"__addListener\",\n      value: function __addListener(callback) {\n        this._listeners.push(callback);\n      }\n    }, {\n      key: \"__removeListener\",\n      value: function __removeListener(callback) {\n        this._listeners = this._listeners.filter(function (listener) {\n          return listener !== callback;\n        });\n      }\n    }, {\n      key: \"__attach\",\n      value: function __attach(viewRef, eventName) {\n        invariant(this.__isNative, 'Only native driven events need to be attached.');\n        this._attachedEvent = attachNativeEvent(viewRef, eventName, this._argMapping);\n      }\n    }, {\n      key: \"__detach\",\n      value: function __detach(viewTag, eventName) {\n        invariant(this.__isNative, 'Only native driven events need to be detached.');\n        this._attachedEvent && this._attachedEvent.detach();\n      }\n    }, {\n      key: \"__getHandler\",\n      value: function __getHandler() {\n        var _this = this;\n\n        if (this.__isNative) {\n          return this._callListeners;\n        }\n\n        return function () {\n          for (var _len = arguments.length, args = new Array(_len), _key2 = 0; _key2 < _len; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n\n          var traverse = function traverse(recMapping, recEvt, key) {\n            if (typeof recEvt === 'number' && recMapping instanceof AnimatedValue) {\n              recMapping.setValue(recEvt);\n            } else if (typeof recMapping === 'object') {\n              for (var mappingKey in recMapping) {\n                traverse(recMapping[mappingKey], recEvt[mappingKey], mappingKey);\n              }\n            }\n          };\n\n          if (!_this.__isNative) {\n            _this._argMapping.forEach(function (mapping, idx) {\n              traverse(mapping, args[idx], 'arg' + idx);\n            });\n          }\n\n          _this._callListeners.apply(_this, args);\n        };\n      }\n    }, {\n      key: \"_callListeners\",\n      value: function _callListeners() {\n        for (var _len2 = arguments.length, args = new Array(_len2), _key3 = 0; _key3 < _len2; _key3++) {\n          args[_key3] = arguments[_key3];\n        }\n\n        this._listeners.forEach(function (listener) {\n          return listener.apply(void 0, args);\n        });\n      }\n    }, {\n      key: \"_validateMapping\",\n      value: function _validateMapping() {\n        var traverse = function traverse(recMapping, recEvt, key) {\n          if (typeof recEvt === 'number') {\n            invariant(recMapping instanceof AnimatedValue, 'Bad mapping of type ' + typeof recMapping + ' for key ' + key + ', event value must map to AnimatedValue');\n            return;\n          }\n\n          invariant(typeof recMapping === 'object', 'Bad mapping of type ' + typeof recMapping + ' for key ' + key);\n          invariant(typeof recEvt === 'object', 'Bad event of type ' + typeof recEvt + ' for key ' + key);\n\n          for (var mappingKey in recMapping) {\n            traverse(recMapping[mappingKey], recEvt[mappingKey], mappingKey);\n          }\n        };\n      }\n    }]);\n\n    return AnimatedEvent;\n  }();\n\n  module.exports = {\n    AnimatedEvent: AnimatedEvent,\n    attachNativeEvent: attachNativeEvent\n  };\n});","map":[[2,0,10,0],[10,0,12,0],[10,6,12,6,"AnimatedValue"],[10,22,12,22,"require"],[10,53,12,30],[10,76,12,22],[10,77,12,0],[12,0,13,0],[12,6,13,6,"NativeAnimatedHelper"],[12,29,13,29,"require"],[12,60,13,37],[12,84,13,29],[12,85,13,0],[14,0,14,0],[14,6,14,6,"ReactNative"],[14,20,14,20,"require"],[14,51,14,28],[14,64,14,20],[14,65,14,0],[16,0,16,0],[16,6,16,6,"invariant"],[16,18,16,18,"require"],[16,49,16,26],[16,69,16,18],[16,70,16,0],[18,17,17,32,"require"],[18,48,17,40],[18,72,17,32],[18,73],[19,6,17,7,"shouldUseNativeDriver"],[19,27],[19,39,17,7,"shouldUseNativeDriver"],[19,60],[21,0,25,0],[21,11,25,9,"attachNativeEvent"],[21,28,25,0],[21,29,26,2,"viewRef"],[21,36,25,0],[21,38,27,2,"eventName"],[21,47,25,0],[21,49,28,2,"argMapping"],[21,59,25,0],[21,61,29,2],[22,0,32,2],[22,8,32,8,"eventMappings"],[22,24,32,24],[22,26,32,2],[24,0,34,2],[24,8,34,8,"traverse"],[24,19,34,19],[24,28,34,8,"traverse"],[24,36,34,19],[24,37,34,20,"value"],[24,42,34,19],[24,44,34,27,"path"],[24,48,34,19],[24,50,34,36],[25,0,35,4],[25,10,35,8,"value"],[25,27,35,25,"AnimatedValue"],[25,40,35,4],[25,42,35,40],[26,0,36,6,"value"],[26,14,36,12,"__makeNative"],[26,26,36,6],[28,0,38,6,"eventMappings"],[28,22,38,20,"push"],[28,26,38,6],[28,27,38,25],[29,0,39,8,"nativeEventPath"],[29,27,39,25,"path"],[29,31,38,25],[30,0,40,8,"animatedValueTag"],[30,28,40,26,"value"],[30,34,40,32,"__getNativeTag"],[30,48,40,26],[31,0,38,25],[31,9,38,6],[32,0,42,5],[32,7,35,4],[32,13,42,11],[32,17,42,15],[32,24,42,22,"value"],[32,29,42,15],[32,34,42,32],[32,42,42,11],[32,44,42,42],[33,0,43,6],[33,13,43,11],[33,17,43,17,"key"],[33,21,43,6],[33,25,43,24,"value"],[33,30,43,6],[33,32,43,31],[34,0,44,8,"traverse"],[34,19,44,17,"value"],[34,25,44,23,"key"],[34,29,44,17],[34,30,44,8],[34,32,44,29,"path"],[34,37,44,34,"concat"],[34,43,44,29],[34,44,44,41,"key"],[34,48,44,29],[34,49,44,8],[35,0,45,7],[36,0,46,5],[37,0,47,3],[37,5,34,2],[39,0,49,2,"invariant"],[39,14,50,4,"argMapping"],[39,25,50,15],[39,26,50,4],[39,31,50,21,"argMapping"],[39,42,50,32],[39,43,50,21],[39,45,50,35,"nativeEvent"],[39,56,49,2],[39,58,51,4],[39,141,49,2],[40,0,55,2,"traverse"],[40,13,55,11,"argMapping"],[40,24,55,22],[40,25,55,11],[40,27,55,25,"nativeEvent"],[40,38,55,2],[40,40,55,38],[40,42,55,2],[41,0,57,2],[41,8,57,8,"viewTag"],[41,18,57,18,"ReactNative"],[41,30,57,30,"findNodeHandle"],[41,44,57,18],[41,45,57,45,"viewRef"],[41,52,57,18],[41,53,57,2],[42,0,59,2,"eventMappings"],[42,18,59,16,"forEach"],[42,25,59,2],[42,26,59,24],[42,45,59,35],[43,0,60,4,"NativeAnimatedHelper"],[43,27,60,25,"API"],[43,30,60,4],[43,31,60,29,"addAnimatedEventToView"],[43,53,60,4],[43,54,61,6,"viewTag"],[43,61,60,4],[43,63,62,6,"eventName"],[43,72,60,4],[43,74,63,6,"mapping"],[43,81,60,4],[44,0,65,3],[44,5,59,2],[45,0,67,2],[45,11,67,9],[46,0,68,4,"detach"],[46,12,67,9],[46,32,68,13],[47,0,69,6,"eventMappings"],[47,22,69,20,"forEach"],[47,29,69,6],[47,30,69,28],[47,49,69,39],[48,0,70,8,"NativeAnimatedHelper"],[48,31,70,29,"API"],[48,34,70,8],[48,35,70,33,"removeAnimatedEventFromView"],[48,62,70,8],[48,63,71,10,"viewTag"],[48,70,70,8],[48,72,72,10,"eventName"],[48,81,70,8],[48,83,73,10,"mapping"],[48,91,73,18,"animatedValueTag"],[48,107,70,8],[49,0,75,7],[49,9,69,6],[50,0,76,5],[51,0,67,9],[51,5,67,2],[52,0,78,1],[54,6,80,6,"AnimatedEvent"],[54,19],[55,0,89,2],[55,27,89,14,"argMapping"],[55,37,89,2],[55,39,89,70],[56,0,89,70],[56,10,89,43,"config"],[56,16,89,70],[56,87,89,66],[56,89,89,70],[58,0,89,70],[60,0,89,70],[60,11,82,2,"_listeners"],[60,21,89,70],[60,24,82,32],[60,26,89,70],[61,0,90,4],[61,11,90,9,"_argMapping"],[61,22,90,4],[61,25,90,23,"argMapping"],[61,35,90,4],[63,0,91,4],[63,10,91,8,"config"],[63,17,91,15,"listener"],[63,25,91,4],[63,27,91,25],[64,0,92,6],[64,13,92,11,"__addListener"],[64,26,92,6],[64,27,92,25,"config"],[64,34,92,32,"listener"],[64,42,92,6],[65,0,93,5],[67,0,94,4],[67,11,94,9,"_callListeners"],[67,25,94,4],[67,28,94,26],[67,33,94,31,"_callListeners"],[67,47,94,26],[67,48,94,46,"bind"],[67,52,94,26],[67,53,94,51],[67,57,94,26],[67,58,94,4],[68,0,95,4],[68,11,95,9,"_attachedEvent"],[68,25,95,4],[68,28,95,26],[68,32,95,4],[69,0,96,4],[69,11,96,9,"__isNative"],[69,21,96,4],[69,24,96,22,"shouldUseNativeDriver"],[69,46,96,44,"config"],[69,52,96,22],[69,53,96,4],[71,0,98,4],[71,10,98,8,"__DEV__"],[71,17,98,4],[71,19,98,17],[72,0,99,6],[72,13,99,11,"_validateMapping"],[72,29,99,6],[73,0,100,5],[74,0,101,3],[78,36,103,16,"callback"],[78,44],[78,46,103,42],[79,0,104,4],[79,13,104,9,"_listeners"],[79,23,104,4],[79,24,104,20,"push"],[79,28,104,4],[79,29,104,25,"callback"],[79,37,104,4],[80,0,105,3],[83,39,107,19,"callback"],[83,47],[83,49,107,45],[84,0,108,4],[84,13,108,9,"_listeners"],[84,23,108,4],[84,26,108,22],[84,31,108,27,"_listeners"],[84,41,108,22],[84,42,108,38,"filter"],[84,48,108,22],[84,49,108,45],[85,0,108,45],[85,17,108,57,"listener"],[85,30,108,70,"callback"],[85,38,108,45],[86,0,108,45],[86,9,108,22],[86,10,108,4],[87,0,109,3],[90,31,111,11,"viewRef"],[90,38],[90,40,111,25,"eventName"],[90,49],[90,51,111,44],[91,0,112,4,"invariant"],[91,18,113,6],[91,23,113,11,"__isNative"],[91,33,112,4],[91,35,114,6],[91,83,112,4],[92,0,117,4],[92,13,117,9,"_attachedEvent"],[92,27,117,4],[92,30,117,26,"attachNativeEvent"],[92,48,118,6,"viewRef"],[92,55,117,26],[92,57,119,6,"eventName"],[92,66,117,26],[92,68,120,6],[92,73,120,11,"_argMapping"],[92,84,117,26],[92,85,117,4],[93,0,122,3],[96,31,124,11,"viewTag"],[96,38],[96,40,124,25,"eventName"],[96,49],[96,51,124,44],[97,0,125,4,"invariant"],[97,18,126,6],[97,23,126,11,"__isNative"],[97,33,125,4],[97,35,127,6],[97,83,125,4],[98,0,130,4],[98,13,130,9,"_attachedEvent"],[98,27,130,4],[98,31,130,27],[98,36,130,32,"_attachedEvent"],[98,50,130,27],[98,51,130,47,"detach"],[98,57,130,27],[98,59,130,4],[99,0,131,3],[102,37,133,17],[103,0,133,17],[105,0,134,4],[105,12,134,8],[105,17,134,13,"__isNative"],[105,27,134,4],[105,29,134,25],[106,0,135,6],[106,17,135,13],[106,22,135,18,"_callListeners"],[106,36,135,6],[107,0,136,5],[109,0,138,4],[109,15,138,11],[109,27,138,29],[110,0,138,29],[110,44,138,15,"args"],[110,48,138,29],[111,0,138,15,"args"],[111,16,138,29],[112,0,138,29],[114,0,139,6],[114,14,139,12,"traverse"],[114,25,139,23],[114,34,139,12,"traverse"],[114,42,139,23],[114,43,139,24,"recMapping"],[114,53,139,23],[114,55,139,36,"recEvt"],[114,61,139,23],[114,63,139,44,"key"],[114,66,139,23],[114,68,139,52],[115,0,140,8],[115,16,140,12],[115,23,140,19,"recEvt"],[115,29,140,12],[115,34,140,30],[115,42,140,12],[115,46,140,42,"recMapping"],[115,68,140,64,"AnimatedValue"],[115,81,140,8],[115,83,140,79],[116,0,141,10,"recMapping"],[116,25,141,21,"setValue"],[116,33,141,10],[116,34,141,30,"recEvt"],[116,40,141,10],[117,0,142,9],[117,13,140,8],[117,19,142,15],[117,23,142,19],[117,30,142,26,"recMapping"],[117,40,142,19],[117,45,142,41],[117,53,142,15],[117,55,142,51],[118,0,143,10],[118,19,143,15],[118,23,143,21,"mappingKey"],[118,33,143,10],[118,37,143,35,"recMapping"],[118,47,143,10],[118,49,143,47],[119,0,147,12,"traverse"],[119,25,147,21,"recMapping"],[119,36,147,32,"mappingKey"],[119,46,147,21],[119,47,147,12],[119,49,147,45,"recEvt"],[119,56,147,52,"mappingKey"],[119,66,147,45],[119,67,147,12],[119,69,147,65,"mappingKey"],[119,79,147,12],[120,0,148,11],[121,0,149,9],[122,0,150,7],[122,11,139,6],[124,0,152,6],[124,14,152,10],[124,15,152,11],[124,21,152,16,"__isNative"],[124,31,152,6],[124,33,152,28],[125,0,153,8],[125,18,153,13,"_argMapping"],[125,29,153,8],[125,30,153,25,"forEach"],[125,37,153,8],[125,38,153,33],[125,48,153,34,"mapping"],[125,55,153,33],[125,57,153,43,"idx"],[125,60,153,33],[125,62,153,51],[126,0,154,10,"traverse"],[126,23,154,19,"mapping"],[126,30,154,10],[126,32,154,28,"args"],[126,37,154,33,"idx"],[126,40,154,28],[126,41,154,10],[126,43,154,39],[126,51,154,47,"idx"],[126,54,154,10],[127,0,155,9],[127,13,153,8],[128,0,156,7],[130,0,157,6],[130,16,157,11,"_callListeners"],[130,30,157,6],[130,44,157,29,"args"],[130,48,157,6],[131,0,158,5],[131,9,138,4],[132,0,159,3],[135,39,161,26],[136,0,161,26],[136,43,161,20,"args"],[136,47,161,26],[137,0,161,20,"args"],[137,14,161,26],[138,0,161,26],[140,0,162,4],[140,13,162,9,"_listeners"],[140,23,162,4],[140,24,162,20,"forEach"],[140,31,162,4],[140,32,162,28],[141,0,162,28],[141,17,162,40,"listener"],[141,40,162,52,"args"],[141,44,162,40],[141,45,162,28],[142,0,162,28],[142,9,162,4],[143,0,163,3],[146,41,165,21],[147,0,166,4],[147,12,166,10,"traverse"],[147,23,166,21],[147,32,166,10,"traverse"],[147,40,166,21],[147,41,166,22,"recMapping"],[147,51,166,21],[147,53,166,34,"recEvt"],[147,59,166,21],[147,61,166,42,"key"],[147,64,166,21],[147,66,166,50],[148,0,167,6],[148,14,167,10],[148,21,167,17,"recEvt"],[148,27,167,10],[148,32,167,28],[148,40,167,6],[148,42,167,38],[149,0,168,8,"invariant"],[149,22,169,10,"recMapping"],[149,44,169,32,"AnimatedValue"],[149,57,168,8],[149,59,170,10],[149,84,171,12],[149,91,171,19,"recMapping"],[149,101,170,10],[149,104,172,12],[149,115,170,10],[149,118,173,12,"key"],[149,121,170,10],[149,124,174,12],[149,165,168,8],[150,0,176,8],[151,0,177,7],[153,0,178,6,"invariant"],[153,20,179,8],[153,27,179,15,"recMapping"],[153,37,179,8],[153,42,179,30],[153,50,178,6],[153,52,180,8],[153,77,180,33],[153,84,180,40,"recMapping"],[153,94,180,8],[153,97,180,53],[153,108,180,8],[153,111,180,67,"key"],[153,114,178,6],[154,0,182,6,"invariant"],[154,20,183,8],[154,27,183,15,"recEvt"],[154,33,183,8],[154,38,183,26],[154,46,182,6],[154,48,184,8],[154,71,184,31],[154,78,184,38,"recEvt"],[154,84,184,8],[154,87,184,47],[154,98,184,8],[154,101,184,61,"key"],[154,104,182,6],[156,0,186,6],[156,15,186,11],[156,19,186,17,"mappingKey"],[156,29,186,6],[156,33,186,31,"recMapping"],[156,43,186,6],[156,45,186,43],[157,0,187,8,"traverse"],[157,21,187,17,"recMapping"],[157,32,187,28,"mappingKey"],[157,42,187,17],[157,43,187,8],[157,45,187,41,"recEvt"],[157,52,187,48,"mappingKey"],[157,62,187,41],[157,63,187,8],[157,65,187,61,"mappingKey"],[157,75,187,8],[158,0,188,7],[159,0,189,5],[159,9,166,4],[160,0,190,3],[166,0,193,0,"module"],[166,9,193,7,"exports"],[166,16,193,0],[166,19,193,17],[167,0,193,18,"AnimatedEvent"],[167,32,193,17],[168,0,193,33,"attachNativeEvent"],[169,0,193,17],[169,3,193,0]]},"type":"js/module"}]}